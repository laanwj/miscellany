from nostr.util import *

def test_function():
    assert embeds_to_tags('[test] Merged PR from laanwj (nostr:nprofile1qqsq4gu7tthengqq577mpdyezkxf90z25g8mvkf355ks2k67km0lwwqpzdmhxue69uhkummnw3ezu7psvchx7un8zn5kcn nostr:npub1p23eukh0nxsqpfaakz6fj9vvj27y4gs0kevnrffdq4d4adkl7uuq7crnl6): pr2 https://github.com/laanwj/test/pull/2')==([['p', '0aa39e5aef99a000a7bdb0b499158c92bc4aa20fb65931a52d055b5eb6dff738', 'wss://nostr.x0f.org'], ['p', '0aa39e5aef99a000a7bdb0b499158c92bc4aa20fb65931a52d055b5eb6dff738']], {'wss://nostr.x0f.org'})
    assert embeds_to_tags('[test] Merged PR from laanwj (nostr:nprofile1qqsq4gu7tthengqq577mpdyezkxf90z25g8mvkf355ks2k67km0lwwqpz3mhxue69uhhyetvv9ujuerpd46hxtnfdur2ev7c): pr5 https://github.com/laanwj/test/pull/5') == ([['p', '0aa39e5aef99a000a7bdb0b499158c92bc4aa20fb65931a52d055b5eb6dff738', 'wss://relay.damus.io']], {'wss://relay.damus.io'})
    assert embeds_to_tags('<nostr:nevent1qqsx4e0dsr3srcf0k45pgryhvdgu47wld0f7ylg5lg3tqfs7snmfs9cpzdmhxue69uhkummnw3ezu7psvchx7un8qy28wumn8ghj7un9d3shjtnyv9kh2uewd9hsz9thwden5te0wp6hyurvv4ex2mrp0yhxxmmd35rvfv>') == ([['e', '6ae5ed80e301e12fb568140c976351caf9df6bd3e27d14fa22b0261e84f69817', 'wss://nostr.x0f.org', 'mention']], {'wss://relay.damus.io', 'wss://nostr.x0f.org', 'wss://purplerelay.com'})
    assert encode_nevent('6ae5ed80e301e12fb568140c976351caf9df6bd3e27d14fa22b0261e84f69817', ['wss://nostr.x0f.org'], 'b7b4ee1454af66f017ef672cce681f37bafaee57ab1b899acc40176b2b537816', 1) == 'nevent1qqsx4e0dsr3srcf0k45pgryhvdgu47wld0f7ylg5lg3tqfs7snmfs9cpzdmhxue69uhkummnw3ezu7psvchx7un8qgst0d8wz3227ehszlhkwtxwdq0n0wh6aet6kxufntxyq9mt9dfhs9srqsqqqqqprz43x5'
    assert encode_npub('b7b4ee1454af66f017ef672cce681f37bafaee57ab1b899acc40176b2b537816') == 'npub1k76wu9z54an0q9l0vukvu6qlx7a04mjh4vdcnxkvgqtkk26n0qtqu0nnlk'
    assert encode_nprofile('b7b4ee1454af66f017ef672cce681f37bafaee57ab1b899acc40176b2b537816', relays=['wss://nostr.x0f.org']) == 'nprofile1qqst0d8wz3227ehszlhkwtxwdq0n0wh6aet6kxufntxyq9mt9dfhs9spzdmhxue69uhkummnw3ezu7psvchx7un8eek43h'
    assert encode_naddr('en-release-28.0', relays=['wss://nostr.x0f.org'], author='b7b4ee1454af66f017ef672cce681f37bafaee57ab1b899acc40176b2b537816', kind=30023) == 'naddr1qq8k2m3dwfjkcetpwdjj6v3c9ccqzymhwden5te0dehhxarj9eurqe3wdaexwq3qk76wu9z54an0q9l0vukvu6qlx7a04mjh4vdcnxkvgqtkk26n0qtqxpqqqp65w02s7av'
    assert decode('nprofile1qqsq4gu7tthengqq577mpdyezkxf90z25g8mvkf355ks2k67km0lwwqpzdmhxue69uhkummnw3ezu7psvchx7un8zn5kcn') == {'hrp': 'nprofile', 'pubkey': bytes.fromhex('0aa39e5aef99a000a7bdb0b499158c92bc4aa20fb65931a52d055b5eb6dff738'), 'relays': ['wss://nostr.x0f.org']}
    assert decode('npub1p23eukh0nxsqpfaakz6fj9vvj27y4gs0kevnrffdq4d4adkl7uuq7crnl6') == {'hrp': 'npub', 'pubkey': bytes.fromhex('0aa39e5aef99a000a7bdb0b499158c92bc4aa20fb65931a52d055b5eb6dff738')}
    assert decode('nevent1qqsr46hsp2e8fl4whjdxfhp2knnzjj088wmu3vh8x50xwaaercftckqhhvjk2') == {'hrp': 'nevent', 'event_id': bytes.fromhex('3aeaf00ab274feaebc9a64dc2ab4e62949e73bb7c8b2e7351e6777b91e12bc58'), 'relays': []}
    assert decode('note10gvceh72dtwe9g2zscfmr6v75va9hd55uv8207g3g3ywknjaqrqs8rtr5w') == {'hrp': 'note', 'event_id': bytes.fromhex('7a198cdfca6add92a1428613b1e99ea33a5bb694e30ea7f9114448eb4e5d00c1')}
